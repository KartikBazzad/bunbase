http:
  routers:
    platform:
      rule: "PathPrefix(`/api`) || Path(`/health`)"
      service: platform
      entryPoints:
        - web

    # Custom domain routing for functions:
    # - {slug}.bunbase.com/function-name
    # - {projectID}.functions.bunbase.com/function-name
    function-subdomain:
      rule: "HostRegexp(`{subdomain:.+}\\.bunbase\\.com`) && PathPrefix(`/`)"
      service: platform
      entryPoints:
        - web

    function-generated:
      rule: "HostRegexp(`{project:.+}\\.functions\\.bunbase\\.com`) && PathPrefix(`/`)"
      service: platform
      entryPoints:
        - web

    web:
      rule: "PathPrefix(`/`)"
      service: web
      entryPoints:
        - web

  services:
    platform:
      loadBalancer:
        servers:
          - url: "http://bunbase-platform:3001"

    web:
      loadBalancer:
        servers:
          - url: "http://bunbase-web:80"
